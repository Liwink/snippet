
### 同步和异步 `pubsub`

#### 背景

* 项目通过 Redis 的 `pubsub` 实现了广播订阅式的异步操作。
* 两个 `Handler` 中都实现发送公告的功能。
* 但两个 `Handler` 的发布实现不同，一个是本地实现发布，另一个是广播出来，异步实现

#### 为什么会在 `season_notification` 中同步实现

志军大爷给出的理由是，`SeasonNotificationHandler` 中实现的功能就是发布公告，于是应该在同步完成就可以。
但在 `SeasonTeamsHandler` 中主要实现的是添加球队，辅助的功能是发送公告，实现主要功能后，辅助功能用异步完成就可以。

上面的确说出了两者的区别，但是作为异步和同步的区别，不够有说服力。

#### 异步实现时需注意的

- 异步实现的任务需要先进队列，如果有太多任务，会阻塞队列。可能任务没有及时完成
- 在任务等待操作的时间，关联的数据库可能被修改，得到的结果和发出请求时的及时结果可能不同
- 对本例来说，如果 `SeasonNotificationHandler` 整块放到异步操作，可能排队的时间里，球队的领队可能被更改，不同的时间处理，收到通知的人也可能不同。
